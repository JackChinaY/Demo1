<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Register</title>
    <link rel="shortcut icon" type="image/x-icon" href="image/favicon.ico"/>
    <link rel="stylesheet" href="zui/zui.css">
    <script src="javascript/jquery-2.0.3.min.js"></script>
    <script src="zui/zui.js"></script>
    <style type="text/css">
        html, body {
            padding: 0;
            margin: 0;
            font-family: Arial;
            font-size: 14px;
            width: 100%;
            height: 100%;
            overflow: auto;
            overflow-x: auto;
            color: #000000;
            filter: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#f5f5f5', endColorStr='#4682B4', gradientType=0); /* IE < 10 */
            background: -ms-linear-gradient(top, #f5f5f5, #4682B4); /* IE 10 */
            background: -webkit-gradient(linear, 0 0, 0 bottom, from(#f5f5f5), to(#4682B4)); /* Webkit: Safari 5.1+, Chrome 10+ */
        }

        .box {
            width: 100%;
            height: 100%;
            /*以下为控制位于此div中的模块垂直和水平居中*/
            display: flex;
            justify-content: center;
            align-items: center;
            padding-top: 30px;
        }

        .box-content {
            width: 700px;
            padding: 30px 0px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        a {
            color: #000000;
            text-decoration: underline;
            cursor: pointer;
        }

        /*.table-context tr {*/
        /*height: 50px;*/
        /*}*/

        /*.table-context tr td input {*/
        /*width: 250px;*/
        /*}*/
    </style>
    <script type="text/javascript">
        $(function () {
            //验证机器编号是否为正品
            $("#machineId").blur(function () {
                if ($("#machineId").val() == "") {
                    $("#checkinfo1").text("Cannot be empty");
                    $("#checkinfo1").css("color", "#FF0000");
                } else {
                    $.ajax({
                        type: "POST",
                        url: "Action_verifyMachine.action",
                        contentType: "application/x-www-form-urlencoded; charset=utf-8",
                        data: {
                            "machineType": $("#machineType").val(),
                            "machineId": $("#machineId").val()
                        },
                        dataType: "json",
                        cache: false,
                        success: function (data) {
                            if (data.jsonObject == "1") {
                                $("#checkinfo1").text("genuine");
                                $("#checkinfo1").css("color", "#008000");
                                $("#submit1").attr('disabled', false);
                            } else if (data.jsonObject == "0") {
                                $("#checkinfo1").text("does not exist");
                                $("#checkinfo1").css("color", "#FF0000");
                            }
                        },
                        error: function (jqXHR) {
                            $("#modal-content").html("The operation failed, please try again. Possible causes:" + jqXHR.status + "！");
                            $("#myModal").modal();
                        }
                    });
                }
            });
            //验证用户名是否存在
            $("#username").blur(function () {
                if ($("#username").val() == "") {
                    $("#checkinfo2").text("Cannot be empty");
                    $("#checkinfo2").css("color", "#FF0000");
                } else {
                    $.ajax({
                        type: "POST",
                        url: "Action_verifyUsername.action",
                        contentType: "application/x-www-form-urlencoded; charset=utf-8",
                        data: {
                            "username": $("#username").val()
                        },
                        dataType: "json",
                        cache: false,
                        success: function (data) {
                            if (data.jsonObject == "0") {
                                $("#checkinfo2").text("available");
                                $("#checkinfo2").css("color", "#008000");
                                $("#submit1").attr('disabled', false);
                            } else if (data.jsonObject == "1") {
                                $("#checkinfo2").text("unavailable");
                                $("#checkinfo2").css("color", "#FF0000");
                            }
                        },
                        error: function (jqXHR) {
                            $("#modal-content").html("The operation failed, please try again. Possible causes:" + jqXHR.status + "！");
                            $("#myModal").modal();
                        }
                    });
                }
            });

            //注册
            $("#submituser").click(function () {
                if ($("#username").val() == "") {
                    new $.zui.Messager('Username cannot be empty！', {
                        type: 'danger',
                        placement: 'center' // 定义显示位置
                    }).show();
                } else if ($("#checkinfo1").text() == "does not exist！") {
                    new $.zui.Messager('the machine id does not exist！', {
                        type: 'danger',
                        placement: 'center'
                    }).show();
                } else if ($("#checkinfo2").text() == "unavailable！") {
                    new $.zui.Messager('This Username is already in use. Please fill in the Username again！', {
                        type: 'danger',
                        placement: 'center'
                    }).show();
                } else if ($("#password").val() == "") {
                    new $.zui.Messager('Password cannot be empty！', {
                        type: 'danger',
                        placement: 'center'
                    }).show();
                } else if ($("#confirm_password").val() == "") {
                    new $.zui.Messager('RePassword cannot be empty！', {
                        type: 'danger',
                        placement: 'center'
                    }).show();
                } else if ($("#email").val() == "") {
                    new $.zui.Messager('E-mail cannot be empty！', {
                        type: 'danger',
                        placement: 'center'
                    }).show();
                } else if ($("#password").val() != $("#confirm_password").val()) {
                    new $.zui.Messager('The Password and Confirm Password are inconsistent！', {
                        type: 'danger',
                        placement: 'center'
                    }).show();
                } else {
                    $.ajax({
                        type: "POST",
                        url: "Action_register.action",
                        contentType: "application/x-www-form-urlencoded; charset=utf-8",
                        data: {
                            "username": $("#username").val(),
                            "password": $("#password").val(),
                            "email": $("#email").val(),
                            "tel": $("#tel").val(),
                            "address": $("#address").val(),
                            "machineType": $("#machineType").val(),
                            "machineId": $("#machineId").val()
                        },
                        dataType: "json",
                        cache: false,
                        success: function (data) {
                            if (data.jsonObject == "1") {
                                $("#modal-content").html("Congratulations on your successful registration!");
                                $("#myModal").modal();
                            } else {
                                $("#modal-content").html("Registration failed. Please re register!");
                                $("#myModal").modal();
                            }
                        },
                        error: function (jqXHR) {
                            $("#modal-content").html("The operation failed, please try again. Possible causes:" + jqXHR.status + "！");
                            $("#myModal").modal();
                        }
                    });
                }
            });

            // 将name=login的文本框清空，以便重新输入
            $("#button_login_clear").click(function () {
                $(".form-control").val("");
            });
        })
    </script>
</head>
<body>
<div style="height: 100px;width: 100%;position: absolute;">
    <div style="float: left"><h1 style="font-family: Arial;">&nbsp;&nbsp;&nbsp;Welcome to register!</h1></div>
    <div style="float: right;margin-right: 50px;margin-top: 10px"><a type="submit" href="login.html" style="font-weight: 900;font-size: 20px;font-family: Arial">Login</a>
    </div>
</div>
<div class="box">
    <div class="box-content">
        <form class="form-horizontal">
            <div class="form-group">
                <label class="col-sm-3">Machine Type</label>
                <div class="col-sm-6">
                    <select id="machineType" class="form-control">
                        <option value="HGT-752" selected="selected">HGT-752</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3">Machine Id</label>
                <div class="col-sm-6">
                    <input id="machineId" type="text" class="form-control" placeholder="please enter the Machine Id">
                </div>
                *
                <span id="checkinfo1"></span>
            </div>
            <div class="form-group">
                <label class="col-sm-3">Username</label>
                <div class="col-sm-6">
                    <input id="username" type="text" class="form-control" placeholder="please enter the Username">
                </div>
                *
                <span id="checkinfo2"></span>
            </div>
            <div class="form-group">
                <label class="col-sm-3">Password</label>
                <div class="col-sm-6">
                    <input id="password" type="password" class="form-control" placeholder="please enter the Password">
                </div>
                *
            </div>
            <div class="form-group">
                <label class="col-sm-3">RePassword</label>
                <div class="col-sm-6">
                    <input id="confirm_password" type="password" class="form-control"
                           placeholder="please re-enter the Password">
                </div>
                *
            </div>
            <div class="form-group">
                <label class="col-sm-3">E-mail</label>
                <div class="col-sm-6">
                    <input id="email" type="text" class="form-control" placeholder="please enter the E-mail">
                </div>
                *
            </div>
            <div class="form-group">
                <label class="col-sm-3">Telephone</label>
                <div class="col-sm-6">
                    <input id="tel" type="number" class="form-control" placeholder="please enter the Telephone">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3">Address</label>
                <div class="col-sm-6">
                    <input id="address" type="text" class="form-control" placeholder="please enter the Address">
                </div>
            </div>
        </form>
        <div style="text-align:center">
            <input class="btn btn-primary" style=" width: 200px;" id="submituser"
                   type="submit" value="Submit">
        </div>
        <!--<input id="button_login_clear" class="btn btn-danger" type="button" style="margin-left: 50px" value="重置">-->
    </div>
    <br>
</div>
<!--对话框-->
<div class="modal fade" id="myModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span
                        class="sr-only">Close</span></button>
                <h4 class="modal-title">Messages</h4>
            </div>
            <div class="modal-body">
                <p id="modal-content" style="font-weight: 800"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-dismiss="modal" onclick="location.href='login.html'">
                    Return to login
                </button>
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
</body>
</html>